{"ast":null,"code":"import _toConsumableArray from \"/home/workspace/react-hooks/sessions/making-api-call-with-hooks-part-2/node_modules/.pnpm/@babel+runtime@7.17.9/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/home/workspace/react-hooks/sessions/making-api-call-with-hooks-part-2/node_modules/.pnpm/@babel+runtime@7.17.9/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/home/workspace/react-hooks/sessions/making-api-call-with-hooks-part-2/src/App.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport List from \"./Components/List\";\nimport { CircularProgress } from \"@mui/material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar App = function App() {\n  _s();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useState5 = useState(1),\n      _useState6 = _slicedToArray(_useState5, 2),\n      page = _useState6[0],\n      setPage = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var priorDate = moment().subtract(30, \"days\").format(\"YYYY-MM-DD\");\n\n  var loadRepositories = function loadRepositories() {\n    axios.get(\"https://api.github.com/search/repositories?q=created:>\".concat(priorDate, \"&sort=stars&order=desc&page=\").concat(page)).then(function (res) {\n      setData(function (prevData) {\n        return [].concat(_toConsumableArray(prevData), _toConsumableArray(res.data.items));\n      });\n      setLoading(false);\n    }).catch(function (error) {\n      setError(error);\n      setLoading(false);\n    });\n  };\n\n  useEffect(function () {\n    loadRepositories();\n  }, [page]);\n  useEffect(function () {\n    window.addEventListener(\"scroll\", handleScroll);\n    return function () {\n      window.removeEventListener(\"scroll\", handleScroll);\n    };\n  }, []);\n\n  var handleScroll = function handleScroll() {\n    var scrolledToBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight;\n\n    if (scrolledToBottom && !loading) {\n      setPage(function (prevPage) {\n        return prevPage + 1;\n      });\n      setLoading(true);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(List, {\n      data: data\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, _this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: \"center\"\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n        style: {\n          color: \"#36D7B7\"\n        },\n        size: 60\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(App, \"QbR9dgRqLEtwlMkRe67vCbh+RgI=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","moment","axios","List","CircularProgress","App","data","setData","error","setError","page","setPage","loading","setLoading","priorDate","subtract","format","loadRepositories","get","then","res","prevData","items","catch","window","addEventListener","handleScroll","removeEventListener","scrolledToBottom","innerHeight","scrollY","document","body","offsetHeight","prevPage","textAlign","color"],"sources":["/home/workspace/react-hooks/sessions/making-api-call-with-hooks-part-2/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport List from \"./Components/List\";\nimport { CircularProgress } from \"@mui/material\";\n\nconst App = () => {\n  const [data, setData] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [loading, setLoading] = useState(false);\n\n  const priorDate = moment().subtract(30, \"days\").format(\"YYYY-MM-DD\");\n\n  const loadRepositories = () => {\n    axios\n      .get(\n        `https://api.github.com/search/repositories?q=created:>${priorDate}&sort=stars&order=desc&page=${page}`\n      )\n      .then((res) => {\n        setData((prevData) => [...prevData, ...res.data.items]);\n        setLoading(false);\n      })\n      .catch((error) => {\n        setError(error);\n        setLoading(false);\n      });\n  };\n\n  useEffect(() => {\n    loadRepositories();\n  }, [page]);\n\n  useEffect(() => {\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => {\n      window.removeEventListener(\"scroll\", handleScroll);\n    };\n  }, []);\n\n  const handleScroll = () => {\n    const scrolledToBottom =\n      window.innerHeight + window.scrollY >= document.body.offsetHeight;\n\n    if (scrolledToBottom && !loading) {\n      setPage((prevPage) => prevPage + 1);\n      setLoading(true);\n    }\n  };\n\n  return (\n    <>\n      <List data={data} />\n      {loading && (\n        <div style={{ textAlign: \"center\" }}>\n          <CircularProgress style={{ color: \"#36D7B7\" }} size={60} />\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default App;\n"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,SAASC,gBAAT,QAAiC,eAAjC;;;;AAEA,IAAMC,GAAG,GAAG,SAANA,GAAM,GAAM;EAAA;;EAChB,gBAAwBN,QAAQ,CAAC,EAAD,CAAhC;EAAA;EAAA,IAAOO,IAAP;EAAA,IAAaC,OAAb;;EACA,iBAA0BR,QAAQ,CAAC,EAAD,CAAlC;EAAA;EAAA,IAAOS,KAAP;EAAA,IAAcC,QAAd;;EACA,iBAAwBV,QAAQ,CAAC,CAAD,CAAhC;EAAA;EAAA,IAAOW,IAAP;EAAA,IAAaC,OAAb;;EACA,iBAA8BZ,QAAQ,CAAC,KAAD,CAAtC;EAAA;EAAA,IAAOa,OAAP;EAAA,IAAgBC,UAAhB;;EAEA,IAAMC,SAAS,GAAGb,MAAM,GAAGc,QAAT,CAAkB,EAAlB,EAAsB,MAAtB,EAA8BC,MAA9B,CAAqC,YAArC,CAAlB;;EAEA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;IAC7Bf,KAAK,CACFgB,GADH,iEAE6DJ,SAF7D,yCAEqGJ,IAFrG,GAIGS,IAJH,CAIQ,UAACC,GAAD,EAAS;MACbb,OAAO,CAAC,UAACc,QAAD;QAAA,oCAAkBA,QAAlB,sBAA+BD,GAAG,CAACd,IAAJ,CAASgB,KAAxC;MAAA,CAAD,CAAP;MACAT,UAAU,CAAC,KAAD,CAAV;IACD,CAPH,EAQGU,KARH,CAQS,UAACf,KAAD,EAAW;MAChBC,QAAQ,CAACD,KAAD,CAAR;MACAK,UAAU,CAAC,KAAD,CAAV;IACD,CAXH;EAYD,CAbD;;EAeAb,SAAS,CAAC,YAAM;IACdiB,gBAAgB;EACjB,CAFQ,EAEN,CAACP,IAAD,CAFM,CAAT;EAIAV,SAAS,CAAC,YAAM;IACdwB,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkCC,YAAlC;IACA,OAAO,YAAM;MACXF,MAAM,CAACG,mBAAP,CAA2B,QAA3B,EAAqCD,YAArC;IACD,CAFD;EAGD,CALQ,EAKN,EALM,CAAT;;EAOA,IAAMA,YAAY,GAAG,SAAfA,YAAe,GAAM;IACzB,IAAME,gBAAgB,GACpBJ,MAAM,CAACK,WAAP,GAAqBL,MAAM,CAACM,OAA5B,IAAuCC,QAAQ,CAACC,IAAT,CAAcC,YADvD;;IAGA,IAAIL,gBAAgB,IAAI,CAAChB,OAAzB,EAAkC;MAChCD,OAAO,CAAC,UAACuB,QAAD;QAAA,OAAcA,QAAQ,GAAG,CAAzB;MAAA,CAAD,CAAP;MACArB,UAAU,CAAC,IAAD,CAAV;IACD;EACF,CARD;;EAUA,oBACE;IAAA,wBACE,QAAC,IAAD;MAAM,IAAI,EAAEP;IAAZ;MAAA;MAAA;MAAA;IAAA,SADF,EAEGM,OAAO,iBACN;MAAK,KAAK,EAAE;QAAEuB,SAAS,EAAE;MAAb,CAAZ;MAAA,uBACE,QAAC,gBAAD;QAAkB,KAAK,EAAE;UAAEC,KAAK,EAAE;QAAT,CAAzB;QAA+C,IAAI,EAAE;MAArD;QAAA;QAAA;QAAA;MAAA;IADF;MAAA;MAAA;MAAA;IAAA,SAHJ;EAAA,gBADF;AAUD,CAtDD;;GAAM/B,G;;KAAAA,G;AAwDN,eAAeA,GAAf"},"metadata":{},"sourceType":"module"}