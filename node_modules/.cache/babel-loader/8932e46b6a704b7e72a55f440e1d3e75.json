{"ast":null,"code":"import _toConsumableArray from\"/home/workspace/react-hooks/sessions/making-api-call-with-hooks-part-2/node_modules/.pnpm/@babel+runtime@7.22.10/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/workspace/react-hooks/sessions/making-api-call-with-hooks-part-2/node_modules/.pnpm/@babel+runtime@7.22.10/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import moment from\"moment\";import axios from\"axios\";import List from\"./Components/List\";import{CircularProgress}from\"@mui/material\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),page=_useState6[0],setPage=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var priorDate=moment().subtract(30,\"days\").format(\"YYYY-MM-DD\");var loadRepositories=function loadRepositories(){axios.get(\"https://api.github.com/search/repositories?q=created:>\".concat(priorDate,\"&sort=stars&order=desc&page=\").concat(page)).then(function(res){setData(function(prevData){return[].concat(_toConsumableArray(prevData),_toConsumableArray(res.data.items));});setLoading(false);}).catch(function(error){setError(error);setLoading(false);});};useEffect(function(){loadRepositories();},[page]);useEffect(function(){window.addEventListener(\"scroll\",handleScroll);return function(){window.removeEventListener(\"scroll\",handleScroll);};},[]);var handleScroll=function handleScroll(){var scrolledToBottom=window.innerHeight+window.scrollY>=document.body.offsetHeight;if(scrolledToBottom&&!loading){setPage(function(prevPage){return prevPage+1;});setLoading(true);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(List,{data:data}),loading&&/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\"},children:/*#__PURE__*/_jsx(CircularProgress,{style:{color:\"#36D7B7\"},size:60})})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","moment","axios","List","CircularProgress","App","data","setData","error","setError","page","setPage","loading","setLoading","priorDate","subtract","format","loadRepositories","get","then","res","prevData","items","catch","window","addEventListener","handleScroll","removeEventListener","scrolledToBottom","innerHeight","scrollY","document","body","offsetHeight","prevPage","textAlign","color"],"sources":["/home/workspace/react-hooks/sessions/making-api-call-with-hooks-part-2/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport List from \"./Components/List\";\nimport { CircularProgress } from \"@mui/material\";\n\nconst App = () => {\n  const [data, setData] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [loading, setLoading] = useState(false);\n\n  const priorDate = moment().subtract(30, \"days\").format(\"YYYY-MM-DD\");\n\n  const loadRepositories = () => {\n    axios\n      .get(\n        `https://api.github.com/search/repositories?q=created:>${priorDate}&sort=stars&order=desc&page=${page}`\n      )\n      .then((res) => {\n        setData((prevData) => [...prevData, ...res.data.items]);\n        setLoading(false);\n      })\n      .catch((error) => {\n        setError(error);\n        setLoading(false);\n      });\n  };\n\n  useEffect(() => {\n    loadRepositories();\n  }, [page]);\n\n  useEffect(() => {\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => {\n      window.removeEventListener(\"scroll\", handleScroll);\n    };\n  }, []);\n\n  const handleScroll = () => {\n    const scrolledToBottom =\n      window.innerHeight + window.scrollY >= document.body.offsetHeight;\n\n    if (scrolledToBottom && !loading) {\n      setPage((prevPage) => prevPage + 1);\n      setLoading(true);\n    }\n  };\n\n  return (\n    <>\n      <List data={data} />\n      {loading && (\n        <div style={{ textAlign: \"center\" }}>\n          <CircularProgress style={{ color: \"#36D7B7\" }} size={60} />\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default App;\n"],"mappings":"oZAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,IAAP,KAAiB,mBAAjB,CACA,OAASC,gBAAT,KAAiC,eAAjC,C,6IAEA,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,CAChB,cAAwBN,QAAQ,CAAC,EAAD,CAAhC,wCAAOO,IAAP,eAAaC,OAAb,eACA,eAA0BR,QAAQ,CAAC,EAAD,CAAlC,yCAAOS,KAAP,eAAcC,QAAd,eACA,eAAwBV,QAAQ,CAAC,CAAD,CAAhC,yCAAOW,IAAP,eAAaC,OAAb,eACA,eAA8BZ,QAAQ,CAAC,KAAD,CAAtC,yCAAOa,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,SAAS,CAAGb,MAAM,GAAGc,QAAT,CAAkB,EAAlB,CAAsB,MAAtB,EAA8BC,MAA9B,CAAqC,YAArC,CAAlB,CAEA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC7Bf,KAAK,CACFgB,GADH,iEAE6DJ,SAF7D,wCAEqGJ,IAFrG,GAIGS,IAJH,CAIQ,SAACC,GAAD,CAAS,CACbb,OAAO,CAAC,SAACc,QAAD,qCAAkBA,QAAlB,qBAA+BD,GAAG,CAACd,IAAJ,CAASgB,KAAxC,IAAD,CAAP,CACAT,UAAU,CAAC,KAAD,CAAV,CACD,CAPH,EAQGU,KARH,CAQS,SAACf,KAAD,CAAW,CAChBC,QAAQ,CAACD,KAAD,CAAR,CACAK,UAAU,CAAC,KAAD,CAAV,CACD,CAXH,EAYD,CAbD,CAeAb,SAAS,CAAC,UAAM,CACdiB,gBAAgB,GACjB,CAFQ,CAEN,CAACP,IAAD,CAFM,CAAT,CAIAV,SAAS,CAAC,UAAM,CACdwB,MAAM,CAACC,gBAAP,CAAwB,QAAxB,CAAkCC,YAAlC,EACA,MAAO,WAAM,CACXF,MAAM,CAACG,mBAAP,CAA2B,QAA3B,CAAqCD,YAArC,EACD,CAFD,CAGD,CALQ,CAKN,EALM,CAAT,CAOA,GAAMA,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB,GAAME,CAAAA,gBAAgB,CACpBJ,MAAM,CAACK,WAAP,CAAqBL,MAAM,CAACM,OAA5B,EAAuCC,QAAQ,CAACC,IAAT,CAAcC,YADvD,CAGA,GAAIL,gBAAgB,EAAI,CAAChB,OAAzB,CAAkC,CAChCD,OAAO,CAAC,SAACuB,QAAD,QAAcA,CAAAA,QAAQ,CAAG,CAAzB,EAAD,CAAP,CACArB,UAAU,CAAC,IAAD,CAAV,CACD,CACF,CARD,CAUA,mBACE,wCACE,KAAC,IAAD,EAAM,IAAI,CAAEP,IAAZ,EADF,CAEGM,OAAO,eACN,YAAK,KAAK,CAAE,CAAEuB,SAAS,CAAE,QAAb,CAAZ,uBACE,KAAC,gBAAD,EAAkB,KAAK,CAAE,CAAEC,KAAK,CAAE,SAAT,CAAzB,CAA+C,IAAI,CAAE,EAArD,EADF,EAHJ,GADF,CAUD,CAtDD,CAwDA,cAAe/B,CAAAA,GAAf"},"metadata":{},"sourceType":"module"}